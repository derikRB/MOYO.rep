@use "sass:color";
@use '../../styles/variables' as *;

/* Shell */
.order-history{
  max-width: 1100px;
  margin: 2rem auto;
  padding: 1.7rem 1vw;
  background: $white;
  border-radius: 18px;
  box-shadow: 0 5px 28px #e6007333;

  .order-history-title{
    color: $primary-pink;
    font-weight: 800;
    font-size: 2.2rem;
    margin: 0 0 1.3rem 0;

    .emoji{ font-size: 1.6em; vertical-align: middle; margin-right: .25rem; }
  }

  /* Filters */
  .filters{
    display:flex; gap:2rem; align-items:center; margin-bottom:1.2rem;
    label{ font-weight:600; color:#333; font-size:1.05rem; }
    select, input[type="date"]{
      margin-left:.5em; padding:.5em 1.1em; border:1.2px solid #ffe0f5;
      border-radius:8px; background:#faf5f9c7; color:$primary-pink; font-size:1.05rem;
    }
  }

  .loading-msg, .empty-msg{
    color:$primary-pink; font-weight:700; text-align:center; font-size:1.1rem; margin:1.6rem 0;
  }

  /* --- Keep desktop layout, allow side-scroll on small screens --- */
  .scroll-wrap{
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-gutter: stable both-edges;
  }
  .desk-width{
    min-width: 1060px;
    margin: 0 auto;
    padding-right: 4px;
  }

  /* Cards */
  .order-list{ display:flex; flex-direction:column; gap:1.6rem; }

  .order-card{
    background:#fff6fa;
    border-radius:15px;
    box-shadow:0 3px 16px #ff80a81f;
    padding: 1.4rem 1.4rem 1.1rem;
    transition: box-shadow .16s;
    &:hover{ box-shadow:0 7px 34px #f8c4e1ad; }

    .order-header{
      display:flex; align-items:center; gap:1.1rem; margin-bottom:.55rem;
      .order-num{ font-size:1.05rem; font-weight:800; color:$primary-pink; }
      .order-date{ color:#666; font-size:.98rem; }
      .order-status{
        margin-left:auto; padding:.35em 1em; border-radius:7px; font-weight:700; background:#ffe6f2; color:$primary-pink;
        &.processing{ background:#f5eaff; color:#7a27b8; }
        &.shipped{ background:#e5f8ff; color:#2196f3; }
        &.delivered{ background:#eaffea; color:#43a047; }
      }
    }

    /* ====== NEW: Compact progress bar ====== */
    .progressbar{
      /* short bar; sticks to the labels row width, not the whole card */
      inline-size: min(480px, 92%);
      margin: .1rem 0 .6rem;
      position: relative;
      user-select: none;
    }
    .progressbar .track{
      height: 4px;
      background: #e9eef1;
      border-radius: 6px;
      position: relative;
    }
    .progressbar .track .fill{
      position: absolute;
      inset: 0 auto 0 0;
      height: 100%;
      width: 0%;
      border-radius: 6px;
      background: $primary-pink;
      transition: width .25s ease;
    }

    .progressbar .steps{
      display:flex;
      justify-content: space-between;
      margin-top: .3rem;
    }
    .progressbar .step{
      display:flex; flex-direction:column; align-items:flex-start; gap:.18rem;
      font-weight: 700; font-size: .95rem; color:#a5a5a5;
    }
    .progressbar .step .dot{
      width: 14px; height: 14px; border-radius: 50%;
      background: #cfd8dc;
      border: 2px solid #cfd8dc;
      box-shadow: 0 0 0 2px #fff6fb; /* subtle white halo on pink card */
    }
    .progressbar .step.active{
      color: #178a43;  /* green caption for active/completed */
    }
    .progressbar .step.active .dot{
      background: #27ae60;
      border-color: #27ae60;
    }
    .progressbar .step .lbl{
      transform: translateY(-2px);
    }
    /* ====== /timeline ====== */

    .order-meta{
      display:flex; gap:2.2rem; flex-wrap:nowrap; color:#222; font-size:1.02rem; margin-bottom:.9rem;
      b{ color:$primary-pink; }
    }

    .order-lines{ margin-top:.6rem; display:flex; flex-direction:column; gap:1.1rem; }

    .order-line{
      display:flex; align-items:flex-start; gap:1rem;

      .line-imgs-side{
        display:flex; flex-direction:column; gap:.32rem; margin-right:1rem;
        .order-img-main{
          width:70px; height:70px; object-fit:cover; border-radius:9px; border:2px solid #ffe1f3; box-shadow:0 1px 8px #f9d3f3; background:#fff;
        }
        .order-img-custom{
          width:55px; height:55px; object-fit:cover; border-radius:8px; border:1.7px solid #f9b8e4;
          cursor:pointer; background:#fff6fa; transition:outline .12s;
          &:hover{ outline:2px solid $primary-pink; }
        }
      }

      .line-details-main{
        flex:1; min-width:0; display:flex; flex-direction:column;

        .line-title{ display:flex; align-items:center; gap:.55rem; flex-wrap:wrap;
          b{ color:#1b1b1b; font-size:1.06rem; }
        }

        .pill{
          font-size:.78rem; font-weight:800; border-radius:999px; padding:.14em .7em; letter-spacing:.02em; white-space:nowrap;
          &.pill-customized{ background:#fde5f8; color:$primary-pink; border:1px solid #ffd6f4; }
        }

        .custom-text{ font-style:italic; color:#ad1981; margin-top:.1em; }
        .custom-meta{
          font-size:.96rem; color:#666; margin:.05em 0 .12em 0;
          .color-box{
            display:inline-block; width:1.05em; height:1.05em; border-radius:4px; border:1px solid #ddd; vertical-align:middle; margin-left:.28em;
          }
        }

        .line-actions{ display:flex; gap:.6rem; margin-top:.35rem; flex-wrap:wrap; }
      }
    }
  }

  /* Buttons (brand-consistent) */
  .btn{
    display:inline-flex; align-items:center; gap:.45rem;
    font-weight:800; font-size:1rem; border-radius:10px; padding:.7rem 1.1rem; cursor:pointer; text-decoration:none;
    transition:background .14s, color .14s, box-shadow .14s;
    i{ font-size:1.05em; }
  }
  .btn-solid{
    background:$primary-pink; color:#fff; box-shadow:0 1px 6px rgba(0,0,0,.1);
    &:hover{ background:color.adjust($primary-pink, $lightness:-10%); }
  }
  .btn-outline{
    background:#fff; color:$primary-pink; border:1.6px solid #ffd0eb;
    &:hover{ background:#ffe7f6; }
  }

  /* Pagination */
  .order-pagination{
    margin:1.4rem auto 0; display:flex; justify-content:center; align-items:center; gap:.35rem;
    button{
      background:#fff0f6; color:$primary-pink; border:1.4px solid #ffe0f5; border-radius:7px;
      padding:.38em 1.18em; font-weight:800; font-size:1.02rem; box-shadow:0 1px 5px #ffd6f7; cursor:pointer;
      transition:background .11s, color .11s;
      &.active, &:hover:not(:disabled){ background:$primary-pink; color:#fff; }
      &:disabled{ opacity:.55; cursor:not-allowed; }
    }
  }

  /* Image modal */
  .image-modal{
    position:fixed; inset:0; background:rgba(0,0,0,.7); display:flex; align-items:center; justify-content:center; z-index:2000;
    img{ max-width:80vw; max-height:80vh; border-radius:13px; box-shadow:0 4px 24px #e6007399; }
  }
}

/* IMPORTANT: No mobile “stacking” overrides. We keep desktop grid and rely on horizontal scroll. */
