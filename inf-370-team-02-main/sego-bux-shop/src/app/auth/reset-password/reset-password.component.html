<div class="form-container">
  <h2>Reset Password</h2>

  <!-- Inline alert for token problems -->
  <div *ngIf="resetError" class="alert alert-danger mb-3">
    {{ resetError }}
    <button
      *ngIf="canResend"
      type="button"
      class="btn btn-outline-pink btn-sm ms-2"
      (click)="resendLink()"
    >
      Send me a new link
    </button>
  </div>

  <form [formGroup]="resetForm" (ngSubmit)="onReset()" novalidate>
    <!-- New password -->
    <label>New Password</label>
    <input
      type="password"
      formControlName="newPassword"
      class="form-control"
      [class.is-invalid]="f['newPassword'].touched && f['newPassword'].invalid"
    />
    <small class="field-error" *ngIf="f['newPassword'].touched && f['newPassword'].hasError('required')">
      Password is required.
    </small>
    <small class="field-error" *ngIf="f['newPassword'].touched && f['newPassword'].hasError('minlength')">
      Minimum 8 characters.
    </small>

    <!-- Confirm password -->
    <label>Confirm New Password</label>
    <input
      type="password"
      formControlName="confirmPassword"
      class="form-control"
      [class.is-invalid]="
        f['confirmPassword'].touched &&
        (f['confirmPassword'].invalid || resetForm.errors?.['mismatch'])
      "
    />
    <small class="field-error" *ngIf="f['confirmPassword'].touched && f['confirmPassword'].hasError('required')">
      Please confirm your password.
    </small>
    <small class="field-error" *ngIf="resetForm.errors?.['mismatch'] && (f['confirmPassword'].touched || f['newPassword'].touched)">
      Passwords do not match.
    </small>

    <button type="submit" class="btn btn-primary" [disabled]="resetForm.invalid || isSubmitting">
      {{ isSubmitting ? 'Resettingâ€¦' : 'Reset Password' }}
    </button>
  </form>
</div>
